<!DOCTYPE html>
<html lang="en">
  <%- include('../partials/header') %>
  <body class="flex min-h-screen flex-col bg-gray-900 text-white">
    <%- include('../partials/nav') %>

    <main
      class="mx-auto w-full max-w-[1366px] flex-grow px-4 py-8 sm:px-6 lg:px-8"
    >
      <!-- Game Header -->
      <div class="mb-8 overflow-hidden rounded-lg bg-gray-800 shadow-2xl">
        <div class="md:flex">
          <div
            class="flex border-b border-gray-700 p-8 md:w-1/3 md:border-r md:border-b-0"
          >
            <% if (game.image !== null) { %>
            <img
              src="<%= game.image %>"
              alt="<%= game.title %>"
              class="h-64 w-full object-contain"
            />
            <% } else { %>
            <div
              class="m-auto flex min-h-96 w-full flex-1 items-center justify-center bg-gray-900"
            >
              <i class="fas fa-image text-4xl text-gray-600"></i>
            </div>
            <% } %>
          </div>
          <div class="p-8 md:w-2/3">
            <h1 class="mb-4 text-4xl font-bold text-white">
              <%= game.title %>
            </h1>

            <div class="mb-6 flex flex-wrap gap-4">
              <div class="rounded-full bg-gray-700 px-3 py-1">
                <span class="text-sm text-gray-300"
                  >Released:
                  <span class="text-white"><%= game.released %></span></span
                >
              </div>
              <div class="rounded-full bg-blue-600 px-3 py-1">
                <span class="text-sm text-white"
                  ><%= game.genre_name || 'Undefined genre' %></span
                >
              </div>

              <div class="rounded-full bg-gray-700 px-3 py-1">
                <span class="text-sm text-gray-300">
                  Developer:
                  <span class="text-white"
                    ><%= game.developer || 'Undefined developer' %></span
                  ></span
                >
              </div>

              <div class="rounded-full bg-gray-700 px-3 py-1">
                <span class="text-sm text-gray-300">
                  Publisher:
                  <span class="text-white"
                    ><%= game.publisher || 'Undefined publisher' %></span
                  ></span
                >
              </div>
            </div>

            <div class="mb-6">
              <h2 class="mb-2 text-lg font-semibold text-gray-300">
                Available Platforms:
              </h2>
              <div class="flex flex-wrap gap-2">
                <% const validPlatforms = game.platforms.filter(platform =>
                platform !== null); %> <% if (validPlatforms.length === 0) { %>
                <span class="rounded-full bg-gray-600 px-3 py-1 text-sm"
                  >Undefined platform</span
                >
                <% } else { %> <% validPlatforms.forEach(platform => { %>
                <span class="rounded-full bg-green-600 px-3 py-1 text-sm"
                  ><%= platform %></span
                >
                <% }) %> <% } %>
              </div>
            </div>

            <!-- Action Buttons -->
            <div class="flex flex-wrap gap-4">
              <a
                href="/games/<%= game.game_id %>/edit"
                class="inline-flex items-center rounded-lg bg-blue-600 px-6 py-3 font-bold text-white transition duration-300 hover:bg-blue-700"
              >
                <i class="fas fa-edit mr-2"></i>
                Edit&nbsp;Game
              </a>

              <form
                method="POST"
                action="/games/<%= game.game_id %>/delete"
                style="display: inline"
                onsubmit="return handleDeleteAction(this, 'game')"
              >
                <input
                  type="hidden"
                  name="adminPassword"
                  class="adminPasswordField"
                />
                <button
                  type="submit"
                  class="inline-flex items-center rounded-lg bg-red-600 px-6 py-3 font-bold text-white transition duration-300 hover:cursor-pointer hover:bg-red-700"
                >
                  <i class="fas fa-trash mr-2"></i>
                  Delete&nbsp;Game
                </button>
              </form>
            </div>
          </div>
        </div>
      </div>

      <!-- Back Button -->
      <div class="mb-8"><%- include('../partials/goBack') %></div>
    </main>

    <script src="/admin.js"></script>
    <%- include('../partials/footer') %> <%-
    include('../partials/passwordModal') %>
  </body>
</html>